<div class="session-history">
  <!-- Progress Calendar -->
  <div class="calendar-section">
    <div class="calendar-header" (click)="toggleCalendar($event)">
      <div class="header-content">
        <span class="header-icon">üìÖ</span>
        <span class="header-title">Progress Calendar</span>
        <span class="header-toggle">{{ showCalendar ? '‚ñº' : '‚ñ≤' }}</span>
      </div>

      <div class="quick-stats" *ngIf="showCalendar">
        <span class="stat">{{ getTotalQuestionsToday() }} questions</span>
        <span class="stat-separator">‚Ä¢</span>
        <span class="stat">{{ getOverallAccuracy() }}% accuracy</span>
      </div>
    </div>

    <div class="calendar-body" *ngIf="showCalendar">
      <mat-calendar
              [selected]="selectedDate"
              [dateClass]="dateClass"
              (selectedChange)="onDateSelected($event)">
      </mat-calendar>
    </div>
  </div>

  <!-- Hist√≥rico / Today's Progress -->
  <div class="progress-section">
    <div class="history-header" (click)="toggleHistory($event)">
      <div class="header-content">
        <span class="header-icon">üìä</span>
        <span class="header-title">{{ getSelectedDateLabel() }}</span>
        <span class="header-toggle">{{ showHistory ? '‚ñº' : '‚ñ≤' }}</span>
      </div>
      <div class="quick-stats" *ngIf="showHistory">
        <span class="stat">{{ getTotalQuestionsToday() }} questions</span>
        <span class="stat-separator">‚Ä¢</span>
        <span class="stat">{{ getOverallAccuracy() }}% accuracy</span>
      </div>
    </div>

    <div class="history-body" *ngIf="showHistory">
      <div class="activity-list" *ngIf="todayActivities?.length; else noActivity">
        <div class="activity-item" *ngFor="let activity of todayActivities">
          <div class="activity-header">
            <span class="activity-module">{{ activity.moduleTitle }}</span>
            <span class="activity-badge"
                  [ngClass]="{ 'high-accuracy': activity.accuracy >= 80 }">
              {{ activity.accuracy }}%
            </span>
          </div>
          <div class="activity-details">
            {{ activity.correctAnswers }}/{{ activity.questionsAnswered }} correct
          </div>
        </div>
      </div>

      <ng-template #noActivity>
        <div class="no-activity">
          <span class="no-activity-icon">üóìÔ∏è</span>
          <p>No learning activity recorded for this date</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
